<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Reset Password</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="/css/main.css" />
  <script>
    async function onSubmit(e){
      e.preventDefault();
      const params = new URLSearchParams(location.search);
      const token = params.get("token");
      if(!token) return alert("Invalid reset link");

      const password = document.getElementById("password").value;
      const confirm = document.getElementById("confirm").value;
      if(password !== confirm) return alert("Passwords do not match");

      const body = new URLSearchParams({ password, confirm });
      const res = await fetch(`/auth/reset/${token}`, {
        method: "POST",
        headers: { "Content-Type": "application/x-www-form-urlencoded" },
        body
      });
      const txt = await res.text();
      alert(txt);
      if (txt.toLowerCase().includes("successful")) location.href = "/login.html";
    }
  </script>
</head>
<body class="login-body">
  <div class="login-container">
    <form class="login-form" onsubmit="onSubmit(event)">
      <h2 class="login-title">Set New Password</h2>

      <div class="form-group">
        <label class="form-label" for="password">New Password</label>
        <input class="form-input" type="password" id="password" required />
      </div>

      <div class="form-group">
        <label class="form-label" for="confirm">Confirm Password</label>
        <input class="form-input" type="password" id="confirm" required />
      </div>

      <button class="login-btn" type="submit">Update Password</button>

      <div class="extra-links">
        <a class="link" href="/login.html">Back to Login</a>
      </div>
    </form>
  </div>
</body>
</html>
